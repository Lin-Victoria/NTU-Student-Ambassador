<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>禮賓學生專區</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 固定標題區域 -->
    <header class="subpage-header">
        <a href="index.html" class="logo-link">
            <img src="logo.png" alt="Logo" class="logo">
        </a>
    </header>


     <!-- 子頁面內容 -->
    <div class="subpage">
        <h2>禮賓學生專區</h2>
        <div class="divider"></div> <!-- 分隔線 -->
        <p>請輸入您的電話號碼後三碼以進入任務點數統計表：</p>
        <form id="student-form" onsubmit="return redirectToGoogleSheet()">
            <input type="text" id="student-id" placeholder="輸入電話號碼後三碼" required>
            <button type="submit">確認</button>
        <p>*如有問題，請洽詢幹部林雨彤 (在Line大群上take我)*</p>
        </p>
        </form>
    </div>

    <script>
        async function loadCSV() {
            const csvURL = "https://drive.google.com/uc?export=download&id=1BPr8o7GD9QJxeGHxHzMQUCrJdLUvJxuT";
            try {
                const response = await fetch(csvURL);
                const csvData = await response.text();
                const rows = csvData.split("\n").map(row => row.split(","));
                
                // 初始化學號對應表
                window.studentLinks = {};
                rows.forEach(([id, link]) => {
                    if (id && link) {
                        window.studentLinks[id.trim()] = link.trim();
                    }
                });
    
                console.log("學號對應表已加載:", window.studentLinks);
            } catch (error) {
                console.error("載入 CSV 時發生錯誤:", error);
            }
        }
    
        async function redirectToGoogleSheet() {
            const studentId = document.getElementById("student-id").value;
            if (window.studentLinks && studentId in window.studentLinks) {
                const googleSheetURL = window.studentLinks[studentId];
                alert(`學號: ${studentId}，即將進入專區`);
                window.open(googleSheetURL, "_blank");
            } else {
                alert("學號不存在或無法讀取連結！");
            }
            return false;
        }
    
        // 在頁面載入時加載 CSV
        document.addEventListener("DOMContentLoaded", loadCSV);
    </script>
    
</body>
</html>
</html>
